?dir
system.file("data",package="loadFile",mustWork=TRUE)
system.file("data","a.xlsx",package="loadFile",mustWork=TRUE)
dir(system.file("data","a.xlsx",package="loadFile",mustWork=TRUE))
?system.file
system.file(package="loadFile",mustWork=TRUE)
system.file("tests/testthat/data",package="loadFile",mustWork=TRUE)
system.file("testthat/data",package="tests",mustWork=TRUE)
dir(system.file("tests/testthat/data",package="loadFile",mustWork=TRUE)
)
a<-dir(system.file("tests/testthat/data",package="loadFile",mustWork=TRUE))
list.files()
setwd(path)
list.files()
setwd(D:/HsuWP/GIT/Rproject/loadFile/tests/testthat)
setwd("D:/HsuWP/GIT/Rproject/loadFile/tests/testthat")
list()
Dataset <- list()
View(Dataset)
list()
setwd(D:/HsuWP/GIT/Rproject/loadFile/tests/testthat/data)
setwd("D:/HsuWP/GIT/Rproject/loadFile/tests/testthat/data")
# "loadEXCEL" FUNCTION ---------------------------------
#set the "loadEXCEL" function
loadEXCEL <- function(Dataname="EXCELdataset", Filepath, File=FALSE, Combine=TRUE, Colname=FALSE, Skip=0) {
setwd(Filepath)
if (File[1]==FALSE) {
Filename <- list.files()
} else {
Filename <- File
}
File_list <- data.frame(Filename)
File_input <- File_list %>%
dplyr::filter(file_extension(Filename) %in% "xlsx")
if (Colname[1]!=FALSE) {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_xlsx(i, col_names=Colname, skip=Skip)
}
}
} else {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_xlsx(i, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_xlsx(i, skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_xlsx(i, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_xlsx(i, skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_xlsx(i, skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_xlsx(i, skip=Skip)
}
}
}
Glo <- .GlobalEnv
assign(Dataname, Dataset, Glo)
rm(File_list, File_input, i,  Glo)
}
# "file_extension" FUNCTION ---------------------------------
#get the file extension
#credit "asperamanka" answered Jan 11, 2022 at 17:22
#https://stackoverflow.com/questions/7779037/extract-file-extension-from-file-path
file_extension <- function(filenames) {
sub(pattern = "^(.*\\.|[^.]+)(?=[^.]*)", replacement = "", filenames, perl = TRUE)
}
loadEXCEL(getwd())
loadEXCEL(Filepath=getwd())
system.file("",package="loadFile",mustWork=TRUE)
system.file("tests/testthat/data",package="loadFile",mustWork=TRUE)
dir(system.file("tests/testthat/data",package="loadFile",mustWork=TRUE))
?source
source("D:/HsuWP/GIT/Rproject/loadFile/R/loadEXCEL.R", echo=TRUE)
?readr_example
devtools::load_all("D:/HsuWP/GIT/Rproject/loadFile")
rm(list = c("loadEXCEL"))
devtools::load_all("D:/HsuWP/GIT/Rproject/loadFile")
system.file("", package="loadFile", mustWork=TRUE)
?read_xlsx
.libPaths()
?.libPaths
paste0(.libPaths(),"loadFile/tests/testthat/data")
paste0(.libPaths(),"/loadFile/tests/testthat/data")
setwd(~/loadFile/tests/testthat/data)
setwd("~/loadFile/tests/testthat/data")
setwd("~/loadFile/tests/testthat/data/")
setwd("~/")
setwd("~/loadFile/tests/testthat/data/")
getwd()
?read_excel
read_excel("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.xlsx")
?read_excel
library("readxl")
read_excel("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.xlsx")
read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.csv")
?read.csv
read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.csv",nrows=4)
read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.csv",nrows=3)
read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.txt",sep="")
a<-read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.txt",sep="")
View(a)
a<-read.csv("https://github.com/Mei-Pin/loadFile/tree/develop/tests/testthat/data/a.csv")
View(a)
?wd
?gsub
gsub(".Rcheck", "", file.path(getwd(), file.path("tests/testthat","/data")))
gsub(".Rcheck", "", file.path(getwd(), file.path("tests/testthat","data")))
setwd(D:/HsuWP/GIT/Rproject/loadFile)
setwd("D:/HsuWP/GIT/Rproject/loadFile")
gsub(".Rcheck", "", file.path(getwd(), file.path("tests/testthat","data")))
gsub(".Rcheck", "", file.path(getwd(), "tests/testthat/data"))
devtools:::run_examples()
?excel-format
?readr_example
?`readxl-package`
?readxl_example
dir(system.file("extdata", package = "loadxl"))
system.file("extdata", package = "loadxl")
dir(system.file("extdata", package = "loadFile"))
system.file("extdata", package = "loadFile")
system.file("data", package = "loadFile")
system.file("data", package = "loadFile")
system.file("data", package = "loadFile")
system.file("data", package = "loadFile")
system.file("data", package = "loadFile")
system.file("extdata", package = "loadFile")
setwd(system.file("extdata", package = "loadFile"))
?list.files
list.files(D:/HsuWP/GIT/Rproject/loadFile)
list.files("D:/HsuWP/GIT/Rproject/loadFile")
setwd(system.file("tests", package = "loadFile"))
system.file("tests", package = "loadFile")
system.file("tests/testthat", package = "loadFile")
system.file("tests/testthat/data", package = "loadFile")
# "loadEXCEL" FUNCTION ---------------------------------
#set the "loadEXCEL" function
loadEXCEL <- function(Dataname="EXCELdataset", Filepath, File=FALSE, Combine=TRUE, Colname=FALSE, Skip=0) {
#setwd(Filepath)
if (File[1]==FALSE) {
Filename <- list.files(Filepath)
} else {
Filename <- File
}
File_list <- data.frame(Filename)
File_input <- File_list %>%
dplyr::filter(file_extension(Filename) %in% "xlsx")
if (Colname[1]!=FALSE) {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
}
Glo <- .GlobalEnv
assign(Dataname, Dataset, Glo)
rm(File_list, File_input, i, Glo)
}
path <- system.file("tests/testthat/data", package = "loadFile")
le=F
ine=T
File=FALSE
Combine=TRUE
Colname=FALSE
Skip=0
# "loadEXCEL" FUNCTION ---------------------------------
#set the "loadEXCEL" function
loadEXCEL <- function(Dataname="EXCELdataset", Filepath, File=FALSE, Combine=TRUE, Colname=FALSE, Skip=0) {
#setwd(Filepath)
if (File[1]==FALSE) {
Filename <- list.files(Filepath)
} else {
Filename <- File
}
File_list <- data.frame(Filename)
File_input <- File_list %>%
dplyr::filter(file_extension(Filename) %in% "xlsx")
if (Colname[1]!=FALSE) {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), col_names=Colname, skip=Skip)
}
}
} else {
if (File[1]==FALSE & Combine==TRUE) {
for (i in File_input$File) {
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
} else if (Combine==TRUE) {
for (i in File){
if (exists("Dataset")) {
Temp_dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
Dataset <- rbind(Dataset, Temp_dataset)
rm(Temp_dataset)
} else {
Dataset <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
} else if (File[1]==FALSE & Combine==FALSE) {
Dataset <- list()
for (i in File_input$File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
} else {
Dataset <- list()
for (i in File) {
Dataset[[i]] <- readxl::read_excel(paste0(Filepath, "/", i), skip=Skip)
}
}
}
Glo <- .GlobalEnv
assign(Dataname, Dataset, Glo)
rm(File_list, File_input, i, Glo)
}
# "file_extension" FUNCTION ---------------------------------
#get the file extension
#credit "asperamanka" answered Jan 11, 2022 at 17:22
#https://stackoverflow.com/questions/7779037/extract-file-extension-from-file-path
file_extension <- function(filenames) {
sub(pattern = "^(.*\\.|[^.]+)(?=[^.]*)", replacement = "", filenames, perl = TRUE)
}
path <- system.file("tests/testthat/data", package = "loadFile")
#' # Load "a.xlsx" and "c.xlsx", then become two tibble in "Test_data".
#' loadEXCEL(Dataname=c("Test_data"), Filepath=path, File=c("a.xlsx",
#' "c.xlsx"), Combine=FALSE)
#'
#' # Load all excel files and skip column title, then set the new.
#' loadEXCEL(Filepath=path, Colname=c("Name_d", "H", "W", "score"), Skip=1)
#'
#' @export
loadEXCEL(Filepath=path)
View(EXCELdataset)
Filename <- list.files(Filepath)
path <- system.file("test/testthat/data", package = "loadFile")
Filepath=path
Filename <- list.files(Filepath)
system.file("test/testthat/data", package = "loadFile")
system.file(
package = "loadFile")
system.file("test
", package = "loadFile")
system.file("tests/testthat/data", package = "loadFile")
path <- system.file("tests/testthat/data", package = "loadFile")
path
path <- paste0(system.file("tests/testthat/data", package = "loadFile"),
"/")
path
Filepath
=
path
Filepath<-path
Filename <- list.files(Filepath)
Filename
File_list <- data.frame(Filename)
File_list
File_input <- File_list %>%
dplyr::filter(file_extension(Filename) %in% "xlsx")
File_input
File_input$File
View(File_input)
File_input$F
paste0(Filepath, "/",
File_input$Filename)
paste0(Filepath, i)
paste0(Filepath,
File_input$Filename)
readxl::read_excel(paste0(Filepath,
File_input$Filename)
)
readxl::read_excel(
readxl::read_excel(
)
)
readxl::read_excel(
"D:/HsuWP/GIT/Rproject/loadFile/tests/testthat/data/c.xlsx")
path
path <- paste0(path,path,"/")
path
path <- system.file("tests/testthat/data", package = "loadFile")
path <- paste0(path,path,"/")
path
path1 <- system.file("tests/testthat/data", package = "loadFile")
path1
path <- grepl("/tests/testthat/data", path1)
path
?gsub
path <- gsub("/tests/testthat/data", path1)
path1 <- system.file("", package = "loadFile")
path1
path <- paste0("tests/testthat/data", path1)
path
path <- paste0(path1, "tests/testthat/data")
path
path <- paste0(path1, "/tests/testthat/data")
path
path1 <- system.file("testthat", package = "loadFile")
path1
path1 <- system.file("tests", package = "loadFile")
path1
path <- paste0(path1, "/testthat/data")
path
path1 <- system.file("exdata", package = "loadFile")
path1
path1 <- system.file("extdata", package = "loadFile")
path1
path <- system.file("tests","testthat", package = "loadFile")
path
path <- system.file("tests/testthat/data","a.xlsx", package = "loadFile")
path
setwd("D:/HsuWP/GIT/Rproject/loadFile/tests/testthat/data")
setwd(system.file("tests/testthat", package = "loadFile"))
?file.path
file.path("tests/testthat/data")
file.path(system.file("tests/testthat/data", package = "loadFile"))
file.path(system.file(package = "loadFile"))
file.path(system.file("extdata", package = "loadFile"))
path1 <- file.path(system.file("extdata", package = "loadFile"))
path1
path <- paste0(path1, "/")
path
path1 <- file.path(system.file(
package = "loadFile"))
path <- paste0(path1, "/")
path1
path
file.path(
system.file(
package = "loadFile"))
file.path(system.file(package = "loadFile"))
file.path(system.file(package = "loadFile"))
path <- getwd()
path
if (grepl("/tests/testthat/data", getwd())) {
path <- path
} else {
path <- paste0(getwd(),"/data")
}
path
paste0(path, "/", "a.xlsx")
a <- readxl::read_excel(paste0(path, "/", "a.xlsx"))
View(a)
devtools::load_all("D:/HsuWP/GIT/Rproject/loadFile")
?loadEXCEL
?loadDELIM
?loadEXCEL
devtools::check(document = FALSE, vignettes = TRUE, run_dont_test = TRUE)
usethis::use_pkgdown()
pkgdown::build_site()
pkgdown::build_site()
?build_site()
devtools::build_site("loadFile")
rlang::last_trace()
writeLines(tools:::example2html("loadEXCEL", "loadFile")$payload)
writeLines(tools:::example2html("loadDELIM", "loadFile")$payload)
?loadEXCEL
install.packages("Mei-Pin/loadFile")
install.github("Mei-Pin/loadFile")
devtools::install.github("Mei-Pin/loadFile")
library(devtools)
devtools::install_github("Mei-Pin/loadFile")
library(loadFile)
?loadEXCEL
View(EXCELdataset)
View(Test_data)
install_github("Mei-Pin/loadFile")
library(devtools)
install_github("Mei-Pin/loadFile")
library(devtools)
install.packages("devtools")
library(devtools)
install.packages("usethis")
library(devtools)
??digest
install.packages("digest")
library(devtools)
install_github("Mei-Pin/loadFile")
library(devtools)
install_github("Mei-Pin/loadFile")
library(loadFile)
